<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Algorithms.CL.RegulatorClassical</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Algorithms-CL-RegulatorClassical.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Algorithms/CL/RegulatorClassical.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">The Quipper System</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Algorithms.CL.RegulatorClassical</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Basic operations on ideals</a></li><li><a href="#g:2">Ideal reductions (bounded)</a></li><li><a href="#g:3">Products of ideals</a></li><li><a href="#g:4">The function f<sub><em>N</em></sub>, and variants</a></li><li><a href="#g:5">Classical period-finding</a><ul><li><a href="#g:6">Auxiliary functions</a></li><li><a href="#g:7">Haskell native arithmetic</a></li><li><a href="#g:8">Fixed-precision arithmetic</a></li></ul></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module implements the classical operations on ideals used in Hallgren&#8217;s
 algorithm (including also classical versions of the quantum operations required).</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:unit_ideal">unit_ideal</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a></li><li class="src short"><a href="#v:unit_idealRed">unit_idealRed</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a></li><li class="src short"><a href="#v:c_of_ideal">c_of_ideal</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a></li><li class="src short"><a href="#v:gamma_of_ideal">gamma_of_ideal</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a></li><li class="src short"><a href="#v:rho">rho</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a></li><li class="src short"><a href="#v:rho_inv">rho_inv</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a></li><li class="src short"><a href="#v:rho_red">rho_red</a> :: <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a></li><li class="src short"><a href="#v:rho_inv_red">rho_inv_red</a> :: <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a></li><li class="src short"><a href="#v:rho_d">rho_d</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></li><li class="src short"><a href="#v:rho_inv_d">rho_inv_d</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></li><li class="src short"><a href="#v:rho_num">rho_num</a> :: (<a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a>, <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a>) -&gt; (<a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a>, <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a>)</li><li class="src short"><a href="#v:rho_red_num">rho_red_num</a> :: (<a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a>, <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a>) -&gt; (<a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a>, <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a>)</li><li class="src short"><a href="#v:reduce">reduce</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a></li><li class="src short"><a href="#v:bounded_reduce">bounded_reduce</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></li><li class="src short"><a href="#v:bounded_step">bounded_step</a> :: (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a>) -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></li><li class="src short"><a href="#v:bounded_step_delta">bounded_step_delta</a> :: (<a href="Algorithms-CL-Types.html#t:CLReal">CLReal</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a>) -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></li><li class="src short"><a href="#v:dot">dot</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></li><li class="src short"><a href="#v:dot-39-">dot'</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></li><li class="src short"><a href="#v:star">star</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></li><li class="src short"><a href="#v:compute_injl">compute_injl</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integral">Integral</a> int =&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; int -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; int -&gt; <a href="Algorithms-CL-Types.html#t:CLReal">CLReal</a></li><li class="src short"><a href="#v:fN">fN</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integral">Integral</a> int =&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; int -&gt; int -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a>, <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a>)</li><li class="src short"><a href="#v:fN_d">fN_d</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integral">Integral</a> int =&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; int -&gt; int -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a>, <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a>)</li><li class="src short"><a href="#v:fJN">fJN</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a>, <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a>)</li><li class="src short"><a href="#v:fJN_d">fJN_d</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a>, <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a>)</li><li class="src short"><a href="#v:order">order</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> a =&gt; (a -&gt; a) -&gt; a -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:order_with_projection">order_with_projection</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> b =&gt; (a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:first_return_with_projection">first_return_with_projection</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> b =&gt; (a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; a</li><li class="src short"><a href="#v:first_return_with_proj_bdd">first_return_with_proj_bdd</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> b =&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; (a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> a</li><li class="src short"><a href="#v:period">period</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> a, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integral">Integral</a> int) =&gt; (int -&gt; a) -&gt; int</li><li class="src short"><a href="#v:regulator">regulator</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="QuipperLib-FPReal.html#t:FPReal">FPReal</a></li><li class="src short"><a href="#v:fundamental_unit">fundamental_unit</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a></li><li class="src short"><a href="#v:fundamental_solution">fundamental_solution</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integer">Integer</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integer">Integer</a>)</li><li class="src short"><a href="#v:regulator_fixed_prec">regulator_fixed_prec</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="QuipperLib-FPReal.html#t:FPReal">FPReal</a></li></ul></div><div id="interface"><h1 id="g:1">Basic operations on ideals</h1><div class="top"><p class="src"><a id="v:unit_ideal" class="def">unit_ideal</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-19" class="link">Source</a> <a href="#v:unit_ideal" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Algorithms-CL-RegulatorClassical.html#v:unit_ideal">unit_ideal</a></code> <em>bigD</em> <em>l</em></code>: the unit ideal <em>O</em>, for &#916; = <em>bigD</em>, with the ideal&#8217;s coefficients given as <em>l</em>-bit integers.  
 (&#91;Jozsa 2003&#93;, Prop. 14.)</p></div></div><div class="top"><p class="src"><a id="v:unit_idealRed" class="def">unit_idealRed</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-23" class="link">Source</a> <a href="#v:unit_idealRed" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Algorithms-CL-RegulatorClassical.html#v:unit_ideal">unit_ideal</a></code>, but considered as a reduced ideal.</p></div></div><div class="top"><p class="src"><a id="v:c_of_ideal" class="def">c_of_ideal</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-30" class="link">Source</a> <a href="#v:c_of_ideal" class="selflink">#</a></p><div class="doc"><p>The integer constant <em>c</em> of an ideal.
   (&#91;Jozsa 2003&#93;, page 14 bottom: &quot;Since 4<em>a</em> divides <em>b</em><sup>2</sup>-<em>D</em>
   (cf. proposition 16) we introduce the integer <em>c</em> = |<em>D</em> &#8722; <em>b</em><sup>2</sup>|/(4<em>a</em>)&quot;)</p></div></div><div class="top"><p class="src"><a id="v:gamma_of_ideal" class="def">gamma_of_ideal</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-40" class="link">Source</a> <a href="#v:gamma_of_ideal" class="selflink">#</a></p><div class="doc"><p>&#947;(<em>I</em>) = (<em>b</em>+&#8730;&#916;)/(2<em>a</em>) for a given ideal <em>I</em>.
   (&#91;Jozsa 2003&#93;, Sec. 6.2.)</p></div></div><div class="top"><p class="src"><a id="v:rho" class="def">rho</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-49" class="link">Source</a> <a href="#v:rho" class="selflink">#</a></p><div class="doc"><p>The reduction function &#961; on ideals.
 (&#91;Jozsa 2003&#93;, Sec. 6.2.)</p></div></div><div class="top"><p class="src"><a id="v:rho_inv" class="def">rho_inv</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-63" class="link">Source</a> <a href="#v:rho_inv" class="selflink">#</a></p><div class="doc"><p>The &#961;<sup>-1</sup> function on ideals.  Inverse to <code><a href="Algorithms-CL-RegulatorClassical.html#v:rho">rho</a></code>.
 (&#91;Jozsa 2003&#93;, Sec. 6.4.)</p></div></div><div class="top"><p class="src"><a id="v:rho_red" class="def">rho_red</a> :: <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-79" class="link">Source</a> <a href="#v:rho_red" class="selflink">#</a></p><div class="doc"><p>The &#961; operation on reduced ideals.</p></div></div><div class="top"><p class="src"><a id="v:rho_inv_red" class="def">rho_inv_red</a> :: <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-83" class="link">Source</a> <a href="#v:rho_inv_red" class="selflink">#</a></p><div class="doc"><p>The &#961;<sup>&#8211;1</sup> operation on reduced ideals.</p></div></div><div class="top"><p class="src"><a id="v:rho_d" class="def">rho_d</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-87" class="link">Source</a> <a href="#v:rho_d" class="selflink">#</a></p><div class="doc"><p>The &#961; operation on ideals-with-distance.</p></div></div><div class="top"><p class="src"><a id="v:rho_inv_d" class="def">rho_inv_d</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-95" class="link">Source</a> <a href="#v:rho_inv_d" class="selflink">#</a></p><div class="doc"><p>The &#961;<sup>&#8211;1</sup> operation on ideals-with-distance.</p></div></div><div class="top"><p class="src"><a id="v:rho_num" class="def">rho_num</a> :: (<a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a>, <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a>) -&gt; (<a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a>, <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a>) <a href="src/Algorithms/CL/RegulatorClassical.html#line-104" class="link">Source</a> <a href="#v:rho_num" class="selflink">#</a></p><div class="doc"><p>The &#961; operation on ideals-with-generator (i.e. pairs of an ideal <em>I</em> and an <code><a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a></code> <em>x</em> such that <em>I</em> is the principal ideal (<em>x</em>)).</p></div></div><div class="top"><p class="src"><a id="v:rho_red_num" class="def">rho_red_num</a> :: (<a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a>, <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a>) -&gt; (<a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a>, <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a>) <a href="src/Algorithms/CL/RegulatorClassical.html#line-108" class="link">Source</a> <a href="#v:rho_red_num" class="selflink">#</a></p><div class="doc"><p>Apply &#961; to an reduced-ideals-with-generator</p></div></div><h1 id="g:2">Ideal reductions (bounded)</h1><div class="top"><p class="src"><a id="v:reduce" class="def">reduce</a> :: <a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdealRed">IdealRed</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-115" class="link">Source</a> <a href="#v:reduce" class="selflink">#</a></p><div class="doc"><p>Reduce an ideal, by repeatedly applying &#961;.</p></div></div><div class="top"><p class="src"><a id="v:bounded_reduce" class="def">bounded_reduce</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-120" class="link">Source</a> <a href="#v:bounded_reduce" class="selflink">#</a></p><div class="doc"><p>Reduce an ideal within a bounded loop. Applies the &#961; function
   until the ideal is reduced. Used in <code><a href="Algorithms-CL-RegulatorClassical.html#v:star">star</a></code> and <code><a href="Algorithms-CL-RegulatorClassical.html#v:fJN">fJN</a></code> algorithms.</p></div></div><div class="top"><p class="src"><a id="v:bounded_step" class="def">bounded_step</a> :: (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a>) -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-135" class="link">Source</a> <a href="#v:bounded_step" class="selflink">#</a></p><div class="doc"><p>Apply a function (like &#961;,&#961;<sup>-1</sup>,&#961;<sup>2</sup>) to an ideal, bounded
   by 3*ln(&#916;)/2*ln(2). Execute while satisfies condition function.</p></div></div><div class="top"><p class="src"><a id="v:bounded_step_delta" class="def">bounded_step_delta</a> :: (<a href="Algorithms-CL-Types.html#t:CLReal">CLReal</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a>) -&gt; (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a>) -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-144" class="link">Source</a> <a href="#v:bounded_step_delta" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Algorithms-CL-RegulatorClassical.html#v:bounded_step">bounded_step</a></code>, but the condition is checked against delta of the
   current ideal.</p></div></div><h1 id="g:3">Products of ideals</h1><div class="top"><p class="src"><a id="v:dot" class="def">dot</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-158" class="link">Source</a> <a href="#v:dot" class="selflink">#</a></p><div class="doc"><p>The ordinary (not necessarily reduced) product of two reduced fractional ideals.</p><p><em>I</em>&#8901;<em>J</em> of &#91;Jozsa 2003&#93;, Sec 7.1, following the description
 given in Prop. 34.</p></div></div><div class="top"><p class="src"><a id="v:dot-39-" class="def">dot'</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-179" class="link">Source</a> <a href="#v:dot-39-" class="selflink">#</a></p><div class="doc"><p>The dot-square <em>I</em>&#8901;<em>I</em> of an ideal-with-distance <em>I</em>.</p></div></div><div class="top"><p class="src"><a id="v:star" class="def">star</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-203" class="link">Source</a> <a href="#v:star" class="selflink">#</a></p><div class="doc"><p>The star-product of two ideals-with-distance.</p><p>This is <em>I</em>*<em>J</em> of &#91;Jozsa 2003&#93;, Sec. 7.1, defined as the first reduced
 ideal-with-distance following <em>I</em>&#8901;<em>J</em>.</p></div></div><h1 id="g:4">The function f<sub><em>N</em></sub>, and variants</h1><div class="top"><p class="src"><a id="v:compute_injl" class="def">compute_injl</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integral">Integral</a> int =&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; int -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; int -&gt; <a href="Algorithms-CL-Types.html#t:CLReal">CLReal</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-218" class="link">Source</a> <a href="#v:compute_injl" class="selflink">#</a></p><div class="doc"><p>Compute the expression i/N + j/L.</p></div></div><div class="top"><p class="src"><a id="v:fN" class="def">fN</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integral">Integral</a> int =&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; int -&gt; int -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a>, <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a>) <a href="src/Algorithms/CL/RegulatorClassical.html#line-226" class="link">Source</a> <a href="#v:fN" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Algorithms-CL-RegulatorClassical.html#v:fN">fN</a></code> <em>i</em> <em>j</em> <em>n</em> <em>l</em> &#916;</code>: find the minimal ideal-with-distance (<em>J</em>,&#948;<sub><em>J</em></sub>) such that &#948;<sub><em>J</em></sub> &gt; <em>x</em>, where <em>x</em> = <em>i</em>/<em>N</em> + <em>j</em>/<em>L</em>, where <em>N</em> = 2<sup><em>n</em></sup>, <em>L</em> = 2<sup><em>l</em></sup>. Return (<em>i</em>,<em>J</em>,&#948;<sub><em>J</em></sub>&#8211;<em>x</em>).  Work under the assumption that <em>R</em> &lt; 2<sup><em>s</em></sup>.</p><p>This is the function <em>h</em> of &#91;Jozsa 2003, Section 9&#93;, discretized with precision 1/<em>N</em> = 2<sup>&#8722;<em>n</em></sup>,
 and perturbed by the jitter parameter <em>j</em>/<em>L</em>.</p></div></div><div class="top"><p class="src"><a id="v:fN_d" class="def">fN_d</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integral">Integral</a> int =&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; int -&gt; int -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a>, <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a>) <a href="src/Algorithms/CL/RegulatorClassical.html#line-232" class="link">Source</a> <a href="#v:fN_d" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Algorithms-CL-RegulatorClassical.html#v:fN">fN</a></code>, but returning an ideal-with-distance not just an ideal.</p></div></div><div class="top"><p class="src"><a id="v:fJN" class="def">fJN</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a>, <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a>) <a href="src/Algorithms/CL/RegulatorClassical.html#line-272" class="link">Source</a> <a href="#v:fJN" class="selflink">#</a></p><div class="doc"><p>Analogue of <code><a href="Algorithms-CL-RegulatorClassical.html#v:fN">fN</a></code>, working within the cycle determined by a given ideal <em>J</em>.
   (&#91;Hallgren 2006&#93;, Section 5.)</p></div></div><div class="top"><p class="src"><a id="v:fJN_d" class="def">fJN_d</a> :: <a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a>, <a href="Algorithms-CL-Types.html#t:CLInt">CLInt</a>) <a href="src/Algorithms/CL/RegulatorClassical.html#line-278" class="link">Source</a> <a href="#v:fJN_d" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Algorithms-CL-RegulatorClassical.html#v:fJN">fJN</a></code>, but returning an ideal-with-distance not just an ideal.</p></div></div><h1 id="g:5">Classical period-finding</h1><div class="doc"><p>Functions for classically finding the regulator and fundamental unit of a field using the period of <em>f_N</em>.</p></div><h2 id="g:6">Auxiliary functions</h2><div class="top"><p class="src"><a id="v:order" class="def">order</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> a =&gt; (a -&gt; a) -&gt; a -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-306" class="link">Source</a> <a href="#v:order" class="selflink">#</a></p><div class="doc"><p>Find the order of an endofunction on an argument.  That is, <code><code><a href="Algorithms-CL-RegulatorClassical.html#v:order">order</a></code> <em>f</em> <em>x</em></code> returns the first <em>n</em> &gt; 0 such that <em>f</em><a href="/x/">sup /n/</a> = <em>x</em>. </p><p>Method: simple brute-force search/comparison.</p></div></div><div class="top"><p class="src"><a id="v:order_with_projection" class="def">order_with_projection</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> b =&gt; (a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-312" class="link">Source</a> <a href="#v:order_with_projection" class="selflink">#</a></p><div class="doc"><p>Given a function <em>p</em>, an endofunction <em>f</em>, and an argument <em>x</em>, returns the first <em>n</em> &gt; 0 such that <em>p</em>(<em>f</em><a href="/x/">sup /n/</a>) = <em>p</em>(<em>x</em>).  </p><p>Method: simple brute-force search/comparison.</p></div></div><div class="top"><p class="src"><a id="v:first_return_with_projection" class="def">first_return_with_projection</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> b =&gt; (a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; a <a href="src/Algorithms/CL/RegulatorClassical.html#line-318" class="link">Source</a> <a href="#v:first_return_with_projection" class="selflink">#</a></p><div class="doc"><p>Given a function <em>p</em>, an endofunction <em>f</em>, and an argument <em>x</em>, return <em>f</em><a href="/x/">sup /n/</a>, for the first <em>n</em> &gt; 0 such that <em>p</em>(<em>f</em><a href="/x/">sup /n/</a>) = <em>p</em>(<em>x</em>).  </p><p>Method: simple brute-force search/comparison.</p></div></div><div class="top"><p class="src"><a id="v:first_return_with_proj_bdd" class="def">first_return_with_proj_bdd</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> b =&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; (a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> a <a href="src/Algorithms/CL/RegulatorClassical.html#line-324" class="link">Source</a> <a href="#v:first_return_with_proj_bdd" class="selflink">#</a></p><div class="doc"><p>Given a bound <em>b</em>, a function <em>p</em>, an endofunction <em>f</em>, and an argument <em>x</em>, return <em>f</em><a href="/x/">sup /n/</a>, for the first <em>n</em> &gt; 0 such that <em>p</em>(<em>f</em><a href="/x/">sup /n/</a>) = <em>p</em>(<em>x</em>), if there exists such an <em>n</em> &#8804; <em>b</em>.</p><p>Method: simple brute-force search/comparison.</p></div></div><div class="top"><p class="src"><a id="v:period" class="def">period</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Eq.html#t:Eq">Eq</a> a, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integral">Integral</a> int) =&gt; (int -&gt; a) -&gt; int <a href="src/Algorithms/CL/RegulatorClassical.html#line-328" class="link">Source</a> <a href="#v:period" class="selflink">#</a></p><div class="doc"><p>Find the period of a function on integers, assuming that it is periodic and injective on its period.  That is, <code><code><a href="Algorithms-CL-RegulatorClassical.html#v:period">period</a></code> <em>f</em></code> returns the first <em>n</em> &gt; 0 such that <em>f</em>(<em>n</em>) = <em>f</em>(0).  Method: simple brute-force search/comparison.</p></div></div><h2 id="g:7">Haskell native arithmetic</h2><div class="doc"><p>The functions of this section use Haskell&#8217;s native integer and floating computation.</p></div><div class="top"><p class="src"><a id="v:regulator" class="def">regulator</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="QuipperLib-FPReal.html#t:FPReal">FPReal</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-340" class="link">Source</a> <a href="#v:regulator" class="selflink">#</a></p><div class="doc"><p>Find the regulator <em>R</em> = log &#949;<sub>0</sub> of a field, given the discriminant &#916;, 
 by finding (classically) the order of &#961;.  </p><p>Uses <code><a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></code> and <code><a href="Algorithms-CL-RegulatorClassical.html#v:rho_d">rho_d</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:fundamental_unit" class="def">fundamental_unit</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="Algorithms-CL-Types.html#t:AlgNum">AlgNum</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-348" class="link">Source</a> <a href="#v:fundamental_unit" class="selflink">#</a></p><div class="doc"><p>Find the fundamental unit &#949;<sub>0</sub> of a field, given the discriminant &#916;, 
 by finding (classically) the order of &#961;.</p><p>Uses '(Ideal,Number)' and <code><a href="Algorithms-CL-RegulatorClassical.html#v:rho_num">rho_num</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:fundamental_solution" class="def">fundamental_solution</a> :: <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integer">Integer</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Integer">Integer</a>) <a href="src/Algorithms/CL/RegulatorClassical.html#line-361" class="link">Source</a> <a href="#v:fundamental_solution" class="selflink">#</a></p><div class="doc"><p>Find the fundamental solution of Pell&#8217;s equation, given <em>d</em>.</p><p>Solutions of Pell&#8217;s equations are integer pairs (<em>x</em>,<em>y</em>) such that
 <em>x</em>,<em>y</em> &gt; 0, and (<em>x</em> + <em>y</em>&#8730;d)(<em>x</em> &#8211; <em>y</em>&#8730;d) = 1.</p><p>In this situation, (<em>x</em> + <em>y</em>&#8730;d) is a unit of the algebraic integers 
 of <em>K</em>, and is &gt;1, so we simply search the powers of &#949;<sub>0</sub> for a
 unit of the desired form.</p></div></div><h2 id="g:8">Fixed-precision arithmetic</h2><div class="doc"><p>The functions of this section perform period-finding using fixed-precision arithmetic.
 This should parallel closely (though at present not exactly, due to the implementations 
 of floating-point operations) the quantum circuit implementations, and hence allows
 testing of whether the chosen precisions are accurate.</p></div><div class="top"><p class="src"><a id="v:regulator_fixed_prec" class="def">regulator_fixed_prec</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Algorithms-CL-Types.html#t:CLIntP">CLIntP</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="QuipperLib-FPReal.html#t:FPReal">FPReal</a> <a href="src/Algorithms/CL/RegulatorClassical.html#line-388" class="link">Source</a> <a href="#v:regulator_fixed_prec" class="selflink">#</a></p><div class="doc"><p>Find the regulator <em>R</em> = log &#949;<sub>0</sub> of a field, given the discriminant &#916;, 
 by finding (classically) the order of &#961;
 using fixed-precision arithmetic: <code><a href="Algorithms-CL-Types.html#v:fix_sizes_Ideal">fix_sizes_Ideal</a></code> for <code><a href="Algorithms-CL-Types.html#t:Ideal">Ideal</a></code>s,
 and given an assumed bound <em>b</em> on log<sub>2</sub> <em>R</em>.</p><p>Uses <code><a href="Algorithms-CL-Types.html#t:IdDist">IdDist</a></code> and <code><a href="Algorithms-CL-RegulatorClassical.html#v:rho_d">rho_d</a></code>.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>
