<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Algorithms.GSE.GSEData</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Algorithms-GSE-GSEData.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Algorithms/GSE/GSEData.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">The Quipper System</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Algorithms.GSE.GSEData</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Data abstraction</a></li><li><a href="#g:2">Reading GSE data from files</a></li><li><a href="#g:3">Low-level access functions</a></li><li><a href="#g:4">Low-level parsing functions</a></li><li><a href="#g:5">Conversion of spin to spatial indices</a></li><li><a href="#g:6">Testing</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module contains functions for reading the GSE one- and
 two-electron integral data from a file, converting this data from
 spatial to spin indices, and accessing the data.</p><p>The external interface consists of the type <code><a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a></code> and the
 function <code><a href="Algorithms-GSE-GSEData.html#v:load_gse_data">load_gse_data</a></code>.</p><p>The Quipper distribution contains example data files
 &quot;<code>h_1e_ascii</code>&quot; and &quot;<code>h_2e_ascii</code>&quot;. These files contain enough
 data for <em>M</em> = 32 spin orbitals (corresponding to <em>M</em>/2 = 16
 spatial orbitals). Note that the example data was randomly
 generated and is only a mock-up. In actual applications, physically
 meaningful data should be substituted.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:GSEData">GSEData</a> = <a href="#v:GSEData">GSEData</a> {<ul class="subs"><li><a href="#v:gse_data_M">gse_data_M</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a></li><li><a href="#v:gse_data_h1">gse_data_h1</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></li><li><a href="#v:gse_data_h2">gse_data_h2</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></li></ul>}</li><li class="src short"><a href="#v:load_gse_data">load_gse_data</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#t:IO">IO</a> <a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a></li><li class="src short"><a href="#v:access_1e">access_1e</a> :: Array (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) e -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; e</li><li class="src short"><a href="#v:access_2e">access_2e</a> :: Array (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) e -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; e</li><li class="src short"><a href="#v:is_comment">is_comment</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:parsefile1">parsefile1</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; Array (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></li><li class="src short"><a href="#v:parsefile2">parsefile2</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; Array (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></li><li class="src short"><a href="#v:spin1">spin1</a> :: ((<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>) -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></li><li class="src short"><a href="#v:spin2">spin2</a> :: ((<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>) -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></li><li class="src short"><a href="#v:print_1e">print_1e</a> :: <a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:print_2e">print_2e</a> :: <a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:gse_data_test">gse_data_test</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#t:IO">IO</a> ()</li></ul></div><div id="interface"><h1 id="g:1">Data abstraction</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:GSEData" class="def">GSEData</a> <a href="src/Algorithms/GSE/GSEData.html#line-25" class="link">Source</a> <a href="#t:GSEData" class="selflink">#</a></p><div class="doc"><p>A data structure describing the GSE Data - the number
 of integrals and the functions to access the data by index.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:GSEData" class="def">GSEData</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:gse_data_M" class="def">gse_data_M</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a></dfn><div class="doc"><p>The number of spin orbitals <em>M</em>.</p></div></li><li><dfn class="src"><a id="v:gse_data_h1" class="def">gse_data_h1</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></dfn><div class="doc"><p>1-electron integrals <em>h</em><sub>p,q</sub> in spin coordinates.</p></div></li><li><dfn class="src"><a id="v:gse_data_h2" class="def">gse_data_h2</a> :: (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></dfn><div class="doc"><p>2-electron integrals <em>h</em><sub>p,q,r,s</sub> in spin coordinates.
 Follows the physics convention for the ordering of indices.</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:GSEData" class="caption collapser" onclick="toggleSection('i:GSEData')">Instances</p><div id="section.i:GSEData" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:GSEData:Show:1" class="instance expander" onclick="toggleSection('i:id:GSEData:Show:1')"></span> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-Show.html#t:Show">Show</a> <a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a></span> <a href="#t:GSEData" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:GSEData:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: &#91;<a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a>&#93; -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h1 id="g:2">Reading GSE data from files</h1><div class="doc"><p>This section provides function for reading one- and two-electron
 GSE data from files. The file formats are as follows. The file for
 the one-electron data consists of lines of the form:</p><pre>((i, j), h)</pre><p>where <em>i</em> and <em>j</em> are integer indices in the range from <em>0</em> to
 <em>M</em>&#8722;1, and <em>h</em> = <em>h</em><sub>i,j</sub> is a real floating point number.
 Please note that the file contains data for (<em>i</em>, <em>j</em>) and
 (<em>j</em>, <em>i</em>), and that the indices <em>i</em> and <em>j</em> are in <em>spatial</em>
 coordinates. The file data is sorted in order of increasing <em>i</em>,
 then <em>j</em>.</p><p>The file for the two-electron data consists of lines of the form:</p><pre>((i, j, k, l), h)</pre><p>where <em>i</em>, <em>j</em>, <em>k</em>, and <em>l</em> are integer indices in the range from
 <em>0</em> to <em>M</em>&#8722;1, and <em>h</em> = <em>h</em><sub>i,k,l,j</sub> is a real floating point
 number. Please note that the indices <em>i</em>, <em>j</em>, <em>k</em>, and <em>l</em> are in
 <em>spatial</em> coordinates, and the ordering of indices in the file
 follows the <em>chemists'</em> convention. Also, to save storage space,
 the file only contains data for <em>i</em> &#8805; <em>j</em>, <em>k</em> &#8805; <em>l</em>, and either
 <em>i</em> &gt; <em>k</em>, or <em>i</em> = <em>k</em> and <em>j</em> &#8805; <em>l</em>. The remaining data must be
 inferred from symmetries. The file data is sorted in order of
 increasing <em>i</em>, then <em>j</em>, then <em>k</em>, then <em>l</em>.</p><p>We also note that the data files, and the functions of this module
 where noted, are the <em>only</em> places where we use Chemists' notation
 and spatial orbitals. The remainder of our implementation uses
 physicists' notation and spin orbitals throughout.</p></div><div class="top"><p class="src"><a id="v:load_gse_data" class="def">load_gse_data</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#t:IO">IO</a> <a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a> <a href="src/Algorithms/GSE/GSEData.html#line-87" class="link">Source</a> <a href="#v:load_gse_data" class="selflink">#</a></p><div class="doc"><p>Read the <code><a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a></code> from two files. The first argument is <em>M</em>, the
 number of spin orbitals. The second and third argument are the
 filenames for the one-electron and two-electron data, respectively.</p><p>If the file contains data for more than <em>M</em> spin orbitals, ignore
 the excess data (this is useful for generating smaller problem
 sizes for testing). In this case, only the necessary portion of the
 file is read. If the file contains data for fewer than <em>M</em> spin
 orbitals, this is silently ignored, but will lead to an
 &quot;undefined&quot; error later.</p></div></div><h1 id="g:3">Low-level access functions</h1><div class="top"><p class="src"><a id="v:access_1e" class="def">access_1e</a> :: Array (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) e -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; e <a href="src/Algorithms/GSE/GSEData.html#line-105" class="link">Source</a> <a href="#v:access_1e" class="selflink">#</a></p><div class="doc"><p>Access 1-electron integral data. The indices are spatial, i.e.,
 they run from 0 to <em>M</em>/2 &#8722; 1.</p></div></div><div class="top"><p class="src"><a id="v:access_2e" class="def">access_2e</a> :: Array (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) e -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; e <a href="src/Algorithms/GSE/GSEData.html#line-113" class="link">Source</a> <a href="#v:access_2e" class="selflink">#</a></p><div class="doc"><p>Access 2-electron integral data. The input array is sparse (i.e.,
 contains only one representative of each equivalence class), and
 uses chemists' conventions. The output uses physicists'
 conventions. The indices in both input and output are spatial,
 i.e., they run from 0 to <em>M</em>/2 &#8722; 1. </p></div></div><h1 id="g:4">Low-level parsing functions</h1><div class="top"><p class="src"><a id="v:is_comment" class="def">is_comment</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="src/Algorithms/GSE/GSEData.html#line-136" class="link">Source</a> <a href="#v:is_comment" class="selflink">#</a></p><div class="doc"><p>Decide whether a string is a comment. A comment is a line with
 only whitespace characters, or where the first non-whitespace
 character is '#'.</p></div></div><div class="top"><p class="src"><a id="v:parsefile1" class="def">parsefile1</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; Array (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a> <a href="src/Algorithms/GSE/GSEData.html#line-146" class="link">Source</a> <a href="#v:parsefile1" class="selflink">#</a></p><div class="doc"><p>Extract an array from the one-electron file data. We do this
 lazily, i.e., we stop reading as soon as enough data is found.
 The resulting array uses spatial indices.</p></div></div><div class="top"><p class="src"><a id="v:parsefile2" class="def">parsefile2</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; Array (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a> <a href="src/Algorithms/GSE/GSEData.html#line-166" class="link">Source</a> <a href="#v:parsefile2" class="selflink">#</a></p><div class="doc"><p>Extract an array from the two-electron file data. We do this
 lazily, i.e., we stop reading as soon as enough data is found.  The
 resulting array uses spatial indices in chemists' notation. Also,
 the output array is sparse; it only contains as much data as the
 file itself.</p></div></div><h1 id="g:5">Conversion of spin to spatial indices</h1><div class="top"><p class="src"><a id="v:spin1" class="def">spin1</a> :: ((<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>) -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a> <a href="src/Algorithms/GSE/GSEData.html#line-207" class="link">Source</a> <a href="#v:spin1" class="selflink">#</a></p><div class="doc"><p>In the molecule we have twice as many orbitals (spin orbitals)
 than data in the integral file (spatial orbitals). This function
 converts <em>h<sub>1</sub></em> from spatial-orbitals (<em>M</em>/2 = 104) to spin
 orbitals (<em>M</em> = 208).</p><p>Spin orbitals are indexed by <em>p</em>=(<em>i</em>, &#963;<em><sub>i</sub></em>), where <em>i</em> is a spatial
 index and &#963;<em><sub>i</sub></em> is a spin (up or down). For two spin indices
 <em>p</em>=(<em>i</em>, &#963;<em><sub>i</sub></em>) and <em>q</em>=(<em>j</em>, &#963;<em><sub>j</sub></em>), the transition integral
 h<sub>pq</sub> is given by the following formula:</p><p><img src="images/spin1.png"></p><p>The Hamiltonian vanishes for &#963;<em><sub>i</sub></em> &#8800; &#963;<em><sub>j</sub></em> because we
 assume that there is no spin orbital coupling.</p><p>Given <em>M</em>/2 spatial orbitals, we re-map the spin orbitals to
 integers from 0 to <em>M</em>&#8722;1 using the formula <em>p</em> = 2<em>i</em>+&#963;<em><sub>i</sub></em>,
 where &#963;<sub>i</sub> is 0 or 1.</p><p>The function <code><a href="Algorithms-GSE-GSEData.html#v:spin1">spin1</a></code> inputs (<em>h<sub>ij</sub></em>), the table of 1-electron
 integrals for <em>M</em>/2 spatial orbitals, and outputs the
 corresponding table (<em>h<sub>pq</sub></em>) for <em>M</em> spin orbitals.</p></div></div><div class="top"><p class="src"><a id="v:spin2" class="def">spin2</a> :: ((<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>) -&gt; (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>, <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>) -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a> <a href="src/Algorithms/GSE/GSEData.html#line-232" class="link">Source</a> <a href="#v:spin2" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Algorithms-GSE-GSEData.html#v:spin1">spin1</a></code>, but for 2-electron integrals. Here, the transition
 integrals in spin coordinates are given by:</p><p><img src="images/spin2.png"></p><p>The Hamiltonian vanishes for &#963;<em><sub>i</sub></em> &#8800; &#963;<em><sub>l</sub></em> or &#963;<em><sub>j</sub></em>
 &#8800; &#963;<em><sub>k</sub></em> because we assume that there is no spin orbital
 coupling.</p><p>The function <code><a href="Algorithms-GSE-GSEData.html#v:spin2">spin2</a></code> inputs (<em>h<sub>ijkl</sub></em>), the table of
 2-electron transition amplitudes for <em>M</em>/2 spatial orbitals, and
 outputs the corresponding table (<em>h<sub>pqrs</sub></em>) for <em>M</em> spin
 orbitals. Index ordering follows the physicists' convention.</p></div></div><h1 id="g:6">Testing</h1><div class="top"><p class="src"><a id="v:print_1e" class="def">print_1e</a> :: <a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> <a href="src/Algorithms/GSE/GSEData.html#line-250" class="link">Source</a> <a href="#v:print_1e" class="selflink">#</a></p><div class="doc"><p>Print the <em>h</em><sub>1</sub> data for 1-electron integrals.</p></div></div><div class="top"><p class="src"><a id="v:print_2e" class="def">print_2e</a> :: <a href="Algorithms-GSE-GSEData.html#t:GSEData">GSEData</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> <a href="src/Algorithms/GSE/GSEData.html#line-258" class="link">Source</a> <a href="#v:print_2e" class="selflink">#</a></p><div class="doc"><p>Print the <em>h</em><sub>2</sub> data for 2-electron integrals.</p></div></div><div class="top"><p class="src"><a id="v:gse_data_test" class="def">gse_data_test</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#t:IO">IO</a> () <a href="src/Algorithms/GSE/GSEData.html#line-266" class="link">Source</a> <a href="#v:gse_data_test" class="selflink">#</a></p><div class="doc"><p>A main function to test the GSEData module.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>
