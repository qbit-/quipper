<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Haskell code</title>
</head>
<body>
<pre><a name="line-1"></a><font color=Blue><i>-- | Helper module for "Algorithms.QLS.QSignedInt": some functions</i></font>
<a name="line-2"></a><font color=Blue><i>-- defined with Template Haskell.</i></font>
<a name="line-3"></a><font color=Green><u>module</u></font> Algorithms<font color=Cyan>.</font>QLS<font color=Cyan>.</font>QSignedIntAux <font color=Green><u>where</u></font>
<a name="line-4"></a>
<a name="line-5"></a><font color=Green><u>import</u></font> Quipper
<a name="line-6"></a><font color=Green><u>import</u></font> QuipperLib<font color=Cyan>.</font>Arith
<a name="line-7"></a>
<a name="line-8"></a>
<a name="line-9"></a>
<a name="line-10"></a><font color=Blue><i>-- | Subtraction on lists of booleans, understood as big-headian,</i></font>
<a name="line-11"></a><font color=Blue><i>-- unsigned integers.</i></font>
<a name="line-12"></a>
<a name="line-13"></a><a name="be_boollist_sub"></a><font color=Blue><i>-- void definition for now</i></font>
<a name="line-14"></a><font color=Blue>be_boollist_sub</font> <font color=Red>::</font> <font color=Red>[</font>Bool<font color=Red>]</font> <font color=Red>-&gt;</font> <font color=Red>[</font>Bool<font color=Red>]</font> <font color=Red>-&gt;</font> <font color=Red>[</font>Bool<font color=Red>]</font>
<a name="line-15"></a><font color=Blue>be_boollist_sub</font> <font color=Red>=</font> error <font color=Magenta>"be_boollist_sub yet undefined."</font>
<a name="line-16"></a>
<a name="line-17"></a>
<a name="line-18"></a><font color=Blue><i>-- Template version of 'be_boollist_sub'.</i></font>
<a name="line-19"></a>
<a name="line-20"></a><a name="template_be_boollist_sub"></a><font color=Blue><i>-- Right now, call to q_sub.</i></font>
<a name="line-21"></a><font color=Blue><i>-- template_be_boollist_sub :: Circ ([Qubit] -&gt; Circ ([Qubit] -&gt; Circ [Qubit]))</i></font>
<a name="line-22"></a><font color=Blue>template_be_boollist_sub</font> <font color=Red>=</font> return <font color=Cyan>$</font> <font color=Red>\</font>x <font color=Red>-&gt;</font> return <font color=Cyan>$</font> <font color=Red>\</font>y <font color=Red>-&gt;</font> <font color=Green><u>do</u></font>
<a name="line-23"></a>                <font color=Green><u>let</u></font> x' <font color=Red>=</font> qdint_of_qulist_bh x
<a name="line-24"></a>                <font color=Green><u>let</u></font> y' <font color=Red>=</font> qdint_of_qulist_bh y
<a name="line-25"></a>                <font color=Cyan>(</font><font color=Green><u>_</u></font><font color=Cyan>,</font><font color=Green><u>_</u></font><font color=Cyan>,</font>z<font color=Cyan>)</font> <font color=Red>&lt;-</font> q_sub x' y'
<a name="line-26"></a>                return <font color=Cyan>$</font> qulist_of_qdint_bh z
<a name="line-27"></a>
<a name="line-28"></a>
<a name="line-29"></a><font color=Blue><i>-- | Addition on lists of booleans, understood as big-headian, unsigned</i></font>
<a name="line-30"></a><font color=Blue><i>-- integers.</i></font>
<a name="line-31"></a>
<a name="line-32"></a><a name="be_boollist_add"></a><font color=Blue><i>-- void definition for now.</i></font>
<a name="line-33"></a><font color=Blue>be_boollist_add</font> <font color=Red>::</font> <font color=Red>[</font>Bool<font color=Red>]</font> <font color=Red>-&gt;</font> <font color=Red>[</font>Bool<font color=Red>]</font> <font color=Red>-&gt;</font> <font color=Red>[</font>Bool<font color=Red>]</font>
<a name="line-34"></a><font color=Blue>be_boollist_add</font> <font color=Red>=</font> error <font color=Magenta>"be_boollist_add yet undefined."</font>
<a name="line-35"></a>
<a name="line-36"></a>
<a name="line-37"></a>
<a name="line-38"></a><font color=Blue><i>-- Template version of 'be_boollist_add'</i></font>
<a name="line-39"></a>
<a name="line-40"></a><a name="template_be_boollist_add"></a><font color=Blue><i>-- Right now, call q_add</i></font>
<a name="line-41"></a><font color=Blue><i>-- template_be_boollist_add :: Circ ([Qubit] -&gt; Circ ([Qubit] -&gt; Circ [Qubit]))</i></font>
<a name="line-42"></a><font color=Blue>template_be_boollist_add</font> <font color=Red>=</font> return <font color=Cyan>$</font> <font color=Red>\</font>x <font color=Red>-&gt;</font> return <font color=Cyan>$</font> <font color=Red>\</font>y <font color=Red>-&gt;</font> <font color=Green><u>do</u></font>
<a name="line-43"></a>                <font color=Green><u>let</u></font> x' <font color=Red>=</font> qdint_of_qulist_bh x
<a name="line-44"></a>                <font color=Green><u>let</u></font> y' <font color=Red>=</font> qdint_of_qulist_bh y
<a name="line-45"></a>                <font color=Cyan>(</font><font color=Green><u>_</u></font><font color=Cyan>,</font><font color=Green><u>_</u></font><font color=Cyan>,</font>z<font color=Cyan>)</font> <font color=Red>&lt;-</font> q_add x' y'
<a name="line-46"></a>                return <font color=Cyan>$</font> qulist_of_qdint_bh z
<a name="line-47"></a>
<a name="line-48"></a>
<a name="line-49"></a>
<a name="line-50"></a><a name="build_circuit"></a><font color=Blue><i>-- | Strict ordering on lists of booleans, understood as big-headian</i></font>
<a name="line-51"></a><font color=Blue><i>-- unsigned integers. If the lists are not of equal length, the</i></font>
<a name="line-52"></a><font color=Blue><i>-- shorter list is treated as if its tail were padded with zeros.</i></font>
<a name="line-53"></a><font color=Blue>build_circuit</font>
<a name="line-54"></a><a name="be_boollist_less"></a><font color=Blue>be_boollist_less</font> <font color=Red>::</font> <font color=Red>[</font>Bool<font color=Red>]</font> <font color=Red>-&gt;</font> <font color=Red>[</font>Bool<font color=Red>]</font> <font color=Red>-&gt;</font> Bool
<a name="line-55"></a><font color=Blue>be_boollist_less</font> l1 l2 <font color=Red>=</font> 
<a name="line-56"></a>  <font color=Green><u>case</u></font> <font color=Cyan>(</font>l1<font color=Cyan>,</font>l2<font color=Cyan>)</font> <font color=Green><u>of</u></font>
<a name="line-57"></a>    <font color=Cyan>(</font>a<font color=Cyan>,</font>[]<font color=Cyan>)</font> <font color=Red>-&gt;</font> False
<a name="line-58"></a>    <font color=Cyan>(</font>[]<font color=Cyan>,</font>a<font color=Cyan>)</font>  <font color=Red>-&gt;</font> be_boollist_less <font color=Red>[</font>False<font color=Red>]</font> a
<a name="line-59"></a>    <font color=Cyan>(</font>h1<font color=Red><b>:</b></font>t1<font color=Cyan>,</font> h2<font color=Red><b>:</b></font>t2<font color=Cyan>)</font> <font color=Red>-&gt;</font> 
<a name="line-60"></a>       <font color=Green><u>let</u></font> parity <font color=Red>=</font> <font color=Green><u>if</u></font> h1 <font color=Green><u>then</u></font> h2 <font color=Green><u>else</u></font> not h2 <font color=Green><u>in</u></font>
<a name="line-61"></a>       <font color=Green><u>if</u></font> parity <font color=Green><u>then</u></font> be_boollist_less t1 t2
<a name="line-62"></a>       <font color=Green><u>else</u></font> h2
<a name="line-63"></a>
<a name="line-64"></a>
<a name="line-65"></a><font color=Blue><i>-- | Strict ordering on lists of booleans, understood as big-headian</i></font>
<a name="line-66"></a><font color=Blue><i>-- signed integers: the 'Bool' in the pair stands for the sign: 'False'</i></font>
<a name="line-67"></a><font color=Blue><i>-- is positive, 'True' is negative.</i></font>
<a name="line-68"></a><font color=Blue>build_circuit</font>
<a name="line-69"></a><a name="be_signed_boollist_less"></a><font color=Blue>be_signed_boollist_less</font> <font color=Red>::</font> <font color=Cyan>(</font>Bool<font color=Cyan>,</font><font color=Red>[</font>Bool<font color=Red>]</font><font color=Cyan>)</font> <font color=Red>-&gt;</font> <font color=Cyan>(</font>Bool<font color=Cyan>,</font><font color=Red>[</font>Bool<font color=Red>]</font><font color=Cyan>)</font> <font color=Red>-&gt;</font> Bool
<a name="line-70"></a><font color=Blue>be_signed_boollist_less</font> <font color=Cyan>(</font>b1<font color=Cyan>,</font>l1<font color=Cyan>)</font> <font color=Cyan>(</font>b2<font color=Cyan>,</font>l2<font color=Cyan>)</font> <font color=Red>=</font> 
<a name="line-71"></a>    <font color=Green><u>if</u></font> b1 <font color=Green><u>then</u></font> <font color=Cyan>(</font><font color=Green><u>if</u></font> b2 <font color=Green><u>then</u></font> be_boollist_less l2 l1  <font color=Green><u>else</u></font> True<font color=Cyan>)</font>
<a name="line-72"></a>    <font color=Green><u>else</u></font>       <font color=Cyan>(</font><font color=Green><u>if</u></font> b2 <font color=Green><u>then</u></font> False <font color=Green><u>else</u></font> be_boollist_less l1 l2<font color=Cyan>)</font>
<a name="line-73"></a>
<a name="line-74"></a>
<a name="line-75"></a><font color=Blue><i>-- | Test whether all elements of a list are 'False'.</i></font>
<a name="line-76"></a><font color=Blue>build_circuit</font>
<a name="line-77"></a><a name="boollist_is_zero"></a><font color=Blue>boollist_is_zero</font> <font color=Red>::</font> <font color=Red>[</font>Bool<font color=Red>]</font> <font color=Red>-&gt;</font> Bool
<a name="line-78"></a><font color=Blue>boollist_is_zero</font> l <font color=Red>=</font>
<a name="line-79"></a>   <font color=Green><u>case</u></font> l <font color=Green><u>of</u></font>
<a name="line-80"></a>     []    <font color=Red>-&gt;</font> True
<a name="line-81"></a>     <font color=Cyan>(</font>h<font color=Red><b>:</b></font>t<font color=Cyan>)</font> <font color=Red>-&gt;</font> <font color=Green><u>if</u></font> h <font color=Green><u>then</u></font> boollist_is_zero t <font color=Green><u>else</u></font> False
<a name="line-82"></a>
<a name="line-83"></a>
<a name="line-84"></a><font color=Blue><i>-- | Addition on signed integers, encoded as big-headian lists of</i></font>
<a name="line-85"></a><font color=Blue><i>-- booleans.</i></font>
<a name="line-86"></a><font color=Blue>build_circuit</font>
<a name="line-87"></a><a name="be_signed_boollist_add"></a><font color=Blue>be_signed_boollist_add</font> <font color=Red>::</font> <font color=Cyan>(</font>Bool<font color=Cyan>,</font><font color=Red>[</font>Bool<font color=Red>]</font><font color=Cyan>)</font> <font color=Red>-&gt;</font> <font color=Cyan>(</font>Bool<font color=Cyan>,</font><font color=Red>[</font>Bool<font color=Red>]</font><font color=Cyan>)</font> <font color=Red>-&gt;</font> <font color=Cyan>(</font>Bool<font color=Cyan>,</font><font color=Red>[</font>Bool<font color=Red>]</font><font color=Cyan>)</font>
<a name="line-88"></a><font color=Blue>be_signed_boollist_add</font> <font color=Cyan>(</font>b<font color=Cyan>,</font>x<font color=Cyan>)</font> <font color=Cyan>(</font>c<font color=Cyan>,</font>y<font color=Cyan>)</font> <font color=Red>=</font>
<a name="line-89"></a>    <font color=Green><u>let</u></font> parity <font color=Red>=</font> <font color=Green><u>if</u></font> b <font color=Green><u>then</u></font> c <font color=Green><u>else</u></font> not c <font color=Green><u>in</u></font>
<a name="line-90"></a>    <font color=Green><u>let</u></font> <font color=Cyan>(</font>d<font color=Cyan>,</font>z<font color=Cyan>)</font> <font color=Red>=</font> <font color=Green><u>if</u></font> parity <font color=Green><u>then</u></font> <font color=Cyan>(</font>b<font color=Cyan>,</font> be_boollist_add x y<font color=Cyan>)</font>
<a name="line-91"></a>                <font color=Green><u>else</u></font> <font color=Green><u>if</u></font> <font color=Cyan>(</font>be_boollist_less x y<font color=Cyan>)</font> <font color=Green><u>then</u></font> <font color=Cyan>(</font>c<font color=Cyan>,</font> be_boollist_sub y x<font color=Cyan>)</font>
<a name="line-92"></a>                <font color=Green><u>else</u></font> <font color=Cyan>(</font>b<font color=Cyan>,</font> be_boollist_sub x y<font color=Cyan>)</font>
<a name="line-93"></a>    <font color=Green><u>in</u></font> <font color=Green><u>if</u></font> <font color=Cyan>(</font>boollist_is_zero z<font color=Cyan>)</font> <font color=Green><u>then</u></font> <font color=Cyan>(</font>False<font color=Cyan>,</font>z<font color=Cyan>)</font> <font color=Green><u>else</u></font> <font color=Cyan>(</font>d<font color=Cyan>,</font>z<font color=Cyan>)</font>
</pre>
</body>
</html>