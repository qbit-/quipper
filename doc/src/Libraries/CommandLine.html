<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Haskell code</title>
</head>
<body>
<pre><a name="line-1"></a><font color=Blue><i>-- | This module provides some functions that are useful in the</i></font>
<a name="line-2"></a><font color=Blue><i>-- processing of command line options, and that are shared between</i></font>
<a name="line-3"></a><font color=Blue><i>-- several algorithms.</i></font>
<a name="line-4"></a>
<a name="line-5"></a><font color=Green><u>module</u></font> Libraries<font color=Cyan>.</font>CommandLine <font color=Green><u>where</u></font>
<a name="line-6"></a>
<a name="line-7"></a><font color=Green><u>import</u></font> Libraries<font color=Cyan>.</font>Auxiliary <font color=Cyan>(</font>string_of_list<font color=Cyan>)</font>
<a name="line-8"></a>
<a name="line-9"></a><font color=Blue><i>-- import other stuff</i></font>
<a name="line-10"></a><font color=Green><u>import</u></font> System<font color=Cyan>.</font>Exit
<a name="line-11"></a><font color=Green><u>import</u></font> System<font color=Cyan>.</font>IO
<a name="line-12"></a><font color=Green><u>import</u></font> Data<font color=Cyan>.</font>List
<a name="line-13"></a><font color=Green><u>import</u></font> Data<font color=Cyan>.</font>Char
<a name="line-14"></a>
<a name="line-15"></a><font color=Blue><i>-- ----------------------------------------------------------------------</i></font>
<a name="line-16"></a><font color=Blue><i>-- * Option processing</i></font>
<a name="line-17"></a>      
<a name="line-18"></a><a name="optfail"></a><font color=Blue><i>-- | Exit with an error message after a command line error. This also</i></font>
<a name="line-19"></a><font color=Blue><i>-- outputs information on where to find command line help.</i></font>
<a name="line-20"></a><font color=Blue>optfail</font> <font color=Red>::</font> String <font color=Red>-&gt;</font> IO a
<a name="line-21"></a><font color=Blue>optfail</font> msg <font color=Red>=</font> <font color=Green><u>do</u></font>
<a name="line-22"></a>  hPutStr stderr msg
<a name="line-23"></a>  hPutStrLn stderr <font color=Magenta>"Try --help for more info."</font>
<a name="line-24"></a>  exitFailure
<a name="line-25"></a>
<a name="line-26"></a><a name="parse_int"></a><font color=Blue><i>-- | Parse a string to an integer, or return 'Nothing' on failure.</i></font>
<a name="line-27"></a><font color=Blue>parse_int</font> <font color=Red>::</font> <font color=Cyan>(</font>Integral r<font color=Cyan>)</font> <font color=Red>=&gt;</font> String <font color=Red>-&gt;</font> Maybe r
<a name="line-28"></a><font color=Blue>parse_int</font> s <font color=Red>=</font> <font color=Green><u>case</u></font> reads s <font color=Green><u>of</u></font>
<a name="line-29"></a>  <font color=Red>[</font><font color=Cyan>(</font>n<font color=Cyan>,</font> <font color=Magenta>""</font><font color=Cyan>)</font><font color=Red>]</font> <font color=Red>-&gt;</font> Just <font color=Cyan>(</font>fromInteger n<font color=Cyan>)</font>
<a name="line-30"></a>  <font color=Green><u>_</u></font> <font color=Red>-&gt;</font> Nothing
<a name="line-31"></a>
<a name="line-32"></a><a name="parse_list_int"></a><font color=Blue><i>-- | Parse a string to a list of integers, or return 'Nothing' on failure.</i></font>
<a name="line-33"></a><font color=Blue>parse_list_int</font> <font color=Red>::</font> String <font color=Red>-&gt;</font> Maybe <font color=Red>[</font>Int<font color=Red>]</font>      
<a name="line-34"></a><font color=Blue>parse_list_int</font> s <font color=Red>=</font> <font color=Green><u>case</u></font> reads s <font color=Green><u>of</u></font>
<a name="line-35"></a>  <font color=Red>[</font><font color=Cyan>(</font>ns<font color=Cyan>,</font> <font color=Magenta>""</font><font color=Cyan>)</font><font color=Red>]</font> <font color=Red>-&gt;</font> Just ns
<a name="line-36"></a>  <font color=Green><u>_</u></font> <font color=Red>-&gt;</font> Nothing
<a name="line-37"></a>
<a name="line-38"></a><a name="parse_double"></a><font color=Blue><i>-- | Parse a string to a 'Double', or return 'Nothing' on failure.</i></font>
<a name="line-39"></a><font color=Blue>parse_double</font> <font color=Red>::</font> String <font color=Red>-&gt;</font> Maybe Double
<a name="line-40"></a><font color=Blue>parse_double</font> s <font color=Red>=</font> <font color=Green><u>case</u></font> reads s <font color=Green><u>of</u></font>
<a name="line-41"></a>  <font color=Red>[</font><font color=Cyan>(</font>n<font color=Cyan>,</font> <font color=Magenta>""</font><font color=Cyan>)</font><font color=Red>]</font> <font color=Red>-&gt;</font> Just n
<a name="line-42"></a>  <font color=Green><u>_</u></font> <font color=Red>-&gt;</font> Nothing
<a name="line-43"></a>
<a name="line-44"></a><a name="match_enum"></a><font color=Blue><i>-- | In an association list, find the key that best matches the given</i></font>
<a name="line-45"></a><font color=Blue><i>-- string. If one key matches exactly, return the corresponding</i></font>
<a name="line-46"></a><font color=Blue><i>-- key-value pair. Otherwise, return a list of all key-value pairs</i></font>
<a name="line-47"></a><font color=Blue><i>-- whose key have the given string as a prefix. This list could be of</i></font>
<a name="line-48"></a><font color=Blue><i>-- length 0 (no match), 1 (unique match), or greater (ambiguous key).</i></font>
<a name="line-49"></a><font color=Blue><i>-- Note: the keys in the association list must be lower case. The</i></font>
<a name="line-50"></a><font color=Blue><i>-- input string is converted to lower case as well, resulting in</i></font>
<a name="line-51"></a><font color=Blue><i>-- case-insensitive matching.</i></font>
<a name="line-52"></a><font color=Blue>match_enum</font> <font color=Red>::</font> <font color=Red>[</font><font color=Cyan>(</font>String<font color=Cyan>,</font> a<font color=Cyan>)</font><font color=Red>]</font> <font color=Red>-&gt;</font> String <font color=Red>-&gt;</font> <font color=Red>[</font><font color=Cyan>(</font>String<font color=Cyan>,</font> a<font color=Cyan>)</font><font color=Red>]</font>
<a name="line-53"></a><font color=Blue>match_enum</font> list key <font color=Red>=</font>
<a name="line-54"></a>  <font color=Green><u>case</u></font> lookup s list <font color=Green><u>of</u></font>
<a name="line-55"></a>    Just v <font color=Red>-&gt;</font> <font color=Red>[</font><font color=Cyan>(</font>s<font color=Cyan>,</font>v<font color=Cyan>)</font><font color=Red>]</font>
<a name="line-56"></a>    Nothing <font color=Red>-&gt;</font> filter <font color=Cyan>(</font><font color=Red>\</font><font color=Cyan>(</font>k<font color=Cyan>,</font>v<font color=Cyan>)</font> <font color=Red>-&gt;</font> isPrefixOf s k<font color=Cyan>)</font> list
<a name="line-57"></a>  <font color=Green><u>where</u></font>
<a name="line-58"></a>    s <font color=Red>=</font> map toLower key
<a name="line-59"></a>    
<a name="line-60"></a><a name="show_enum"></a><font color=Blue><i>-- | Pretty-print a list of possible values for a parameter. The</i></font>
<a name="line-61"></a><font color=Blue><i>-- first argument is the name of the parameter, and the second</i></font>
<a name="line-62"></a><font color=Blue><i>-- argument is its enumeration.</i></font>
<a name="line-63"></a><font color=Blue>show_enum</font> <font color=Red>::</font> String <font color=Red>-&gt;</font> <font color=Red>[</font><font color=Cyan>(</font>String<font color=Cyan>,</font> a<font color=Cyan>)</font><font color=Red>]</font> <font color=Red>-&gt;</font> String    
<a name="line-64"></a><font color=Blue>show_enum</font> param list <font color=Red>=</font>
<a name="line-65"></a>  <font color=Magenta>"Possible values for "</font> <font color=Cyan>++</font> param <font color=Cyan>++</font> <font color=Magenta>" are: "</font> <font color=Cyan>++</font>
<a name="line-66"></a>  string_of_list <font color=Magenta>""</font> <font color=Magenta>", "</font> <font color=Magenta>""</font> <font color=Magenta>"no possible values"</font> fst list <font color=Cyan>++</font> <font color=Magenta>".\n"</font>
</pre>
</body>
</html>