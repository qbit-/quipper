<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Programs.QCLParser.Main</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Programs-QCLParser-Main.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Programs/QCLParser/Main.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">The Quipper System</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Programs.QCLParser.Main</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">A monad for a QCL state</a></li><li><a href="#g:2">Auxiliary state functions</a></li><li><a href="#g:3">Implementation of the QCL primitives</a></li><li><a href="#g:4">Unpacking QCLCirc</a></li><li><a href="#g:5">An abstract syntax for QCL output</a></li><li><a href="#g:6">Parsing</a></li><li><a href="#g:7">Main function</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This program reads an execution trace produced by QCL, and turns
 it into a Quipper circuit.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:QCLState">QCLState</a> = <a href="http://hackage.haskell.org/package/containers-0.5.7.1/docs/Data-IntMap-Strict.html#t:IntMap">IntMap</a> <a href="Quipper-Monad.html#t:Qubit">Qubit</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:QCLCirc">QCLCirc</a> a = StateT <a href="Programs-QCLParser-Main.html#t:QCLState">QCLState</a> <a href="Quipper-Monad.html#t:Circ">Circ</a> a</li><li class="src short"><a href="#v:provide">provide</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> <a href="Quipper-Monad.html#t:Qubit">Qubit</a></li><li class="src short"><a href="#v:qcl_reset">qcl_reset</a> :: <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:qcl_cnot">qcl_cnot</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:qcl_not">qcl_not</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:qcl_fanout">qcl_fanout</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:sqdist">sqdist</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></li><li class="src short"><a href="#v:matrix_w">matrix_w</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:matrix_exp">matrix_exp</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></li><li class="src short"><a href="#v:qcl_matrix">qcl_matrix</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:qcl_cnot_inv">qcl_cnot_inv</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:qcl_not_inv">qcl_not_inv</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:qcl_fanout_inv">qcl_fanout_inv</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:testcircuit1">testcircuit1</a> :: <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:run">run</a> :: <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> a -&gt; <a href="Quipper-Monad.html#t:Circ">Circ</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:QCLGate">QCLGate</a><ul class="subs"><li>= <a href="#v:Comment">Comment</a></li><li>| <a href="#v:Reset">Reset</a></li><li>| <a href="#v:Not">Not</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a></li><li>| <a href="#v:XNot">XNot</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a></li><li>| <a href="#v:CNot">CNot</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</li><li>| <a href="#v:XCNot">XCNot</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</li><li>| <a href="#v:Fanout">Fanout</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</li><li>| <a href="#v:XFanout">XFanout</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</li><li>| <a href="#v:Matrix">Matrix</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</li><li>| <a href="#v:XMatrix">XMatrix</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</li></ul></li><li class="src short"><a href="#v:do_qcl_gate">do_qcl_gate</a> :: <a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:identifier">identifier</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:int">int</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:double">double</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a></li><li class="src short"><a href="#v:commalist">commalist</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> a -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> &#91;a&#93;</li><li class="src short"><a href="#v:qureg">qureg</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a>, &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;)</li><li class="src short"><a href="#v:inversechar">inversechar</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:complex">complex</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>)</li><li class="src short"><a href="#v:qcl_line">qcl_line</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a></li><li class="src short"><a href="#v:parse_qcl_line">parse_qcl_line</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a></li><li class="src short"><a href="#v:run_qcl_line">run_qcl_line</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:run_qcl_lines">run_qcl_lines</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:testcircuit2">testcircuit2</a> :: <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> ()</li><li class="src short"><a href="#v:main">main</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#t:IO">IO</a> ()</li></ul></div><div id="interface"><h1 id="g:1">A monad for a QCL state</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:QCLState" class="def">QCLState</a> = <a href="http://hackage.haskell.org/package/containers-0.5.7.1/docs/Data-IntMap-Strict.html#t:IntMap">IntMap</a> <a href="Quipper-Monad.html#t:Qubit">Qubit</a> <a href="src/Programs/QCLParser/Main.html#line-33" class="link">Source</a> <a href="#t:QCLState" class="selflink">#</a></p><div class="doc"><p>In QCL, qubits are identified by integers. We have to map these
 to Quipper's native qubits. A <code><a href="Programs-QCLParser-Main.html#t:QCLState">QCLState</a></code> holds such a map.
 Implicitly, it also holds the set of qubits currently defined.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:QCLCirc" class="def">QCLCirc</a> a = StateT <a href="Programs-QCLParser-Main.html#t:QCLState">QCLState</a> <a href="Quipper-Monad.html#t:Circ">Circ</a> a <a href="src/Programs/QCLParser/Main.html#line-39" class="link">Source</a> <a href="#t:QCLCirc" class="selflink">#</a></p><div class="doc"><p>The <code><a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a></code> monad is like the <code><a href="Quipper-Monad.html#t:Circ">Circ</a></code> monad, except that it also
 keeps track of an additional <code><a href="Programs-QCLParser-Main.html#t:QCLState">QCLState</a></code>. The <code>lift</code> function must
 be used to lift any command for the <code><a href="Quipper-Monad.html#t:Circ">Circ</a></code> monad to the <code><a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a></code>
 monad.</p></div></div><h1 id="g:2">Auxiliary state functions</h1><div class="top"><p class="src"><a id="v:provide" class="def">provide</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> <a href="Quipper-Monad.html#t:Qubit">Qubit</a> <a href="src/Programs/QCLParser/Main.html#line-46" class="link">Source</a> <a href="#v:provide" class="selflink">#</a></p><div class="doc"><p>Look up the qubit corresponding to a QCL register, or allocate a
 new qubit if it doesn't already exist.</p></div></div><h1 id="g:3">Implementation of the QCL primitives</h1><div class="top"><p class="src"><a id="v:qcl_reset" class="def">qcl_reset</a> :: <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-61" class="link">Source</a> <a href="#v:qcl_reset" class="selflink">#</a></p><div class="doc"><p>Reset all qubits to state 0.</p></div></div><div class="top"><p class="src"><a id="v:qcl_cnot" class="def">qcl_cnot</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-70" class="link">Source</a> <a href="#v:qcl_cnot" class="selflink">#</a></p><div class="doc"><p>Apply a controlled-not operation to the first argument.</p></div></div><div class="top"><p class="src"><a id="v:qcl_not" class="def">qcl_not</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-78" class="link">Source</a> <a href="#v:qcl_not" class="selflink">#</a></p><div class="doc"><p>Apply an uncontrolled not operation.</p></div></div><div class="top"><p class="src"><a id="v:qcl_fanout" class="def">qcl_fanout</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-85" class="link">Source</a> <a href="#v:qcl_fanout" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Programs-QCLParser-Main.html#v:qcl_fanout">qcl_fanout</a></code> ins outs ctrls</code>: Copy the qubit register <em>ins</em> to
 the qubit register <em>outs</em> by means of c-not operations, provided
 that <em>outs</em> was previously 0. The whole operation is controlled by
 <em>ctrls</em>.</p></div></div><div class="top"><p class="src"><a id="v:sqdist" class="def">sqdist</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a> <a href="src/Programs/QCLParser/Main.html#line-97" class="link">Source</a> <a href="#v:sqdist" class="selflink">#</a></p><div class="doc"><p>Calculate the square distance between two vectors, which must be
 of the same length.</p></div></div><div class="top"><p class="src"><a id="v:matrix_w" class="def">matrix_w</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="src/Programs/QCLParser/Main.html#line-104" class="link">Source</a> <a href="#v:matrix_w" class="selflink">#</a></p><div class="doc"><p>If the matrix looks like a <em>W</em>-gate, return <code><a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#v:True">True</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:matrix_exp" class="def">matrix_exp</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a> <a href="src/Programs/QCLParser/Main.html#line-120" class="link">Source</a> <a href="#v:matrix_exp" class="selflink">#</a></p><div class="doc"><p>If the matrix looks like a controlled <em>e</em>^<em>tiZ</em>-gate, return the
 angle <em>t</em>.</p></div></div><div class="top"><p class="src"><a id="v:qcl_matrix" class="def">qcl_matrix</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-142" class="link">Source</a> <a href="#v:qcl_matrix" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Programs-QCLParser-Main.html#v:qcl_matrix">qcl_matrix</a></code> n amps regs</code>: Apply the <em>n</em>-by-<em>n</em> unitary gate
 whose matrix is given in <em>amps</em>, to the qubit list <em>regs</em>.  This
 function must guess, based on the complex entries of the matrix,
 what the name of the gate should be. This guessing is crude at the
 moment, and must be extended to include additional gates as
 required by each algorithm. If the first argument is <code><a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#v:True">True</a></code>, invert
 the matrix.</p></div></div><div class="top"><p class="src"><a id="v:qcl_cnot_inv" class="def">qcl_cnot_inv</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-157" class="link">Source</a> <a href="#v:qcl_cnot_inv" class="selflink">#</a></p><div class="doc"><p>The inverse of <code><a href="Programs-QCLParser-Main.html#v:qcl_cnot">qcl_cnot</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:qcl_not_inv" class="def">qcl_not_inv</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-160" class="link">Source</a> <a href="#v:qcl_not_inv" class="selflink">#</a></p><div class="doc"><p>The inverse of <code><a href="Programs-QCLParser-Main.html#v:qcl_not">qcl_not</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:qcl_fanout_inv" class="def">qcl_fanout_inv</a> :: &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-163" class="link">Source</a> <a href="#v:qcl_fanout_inv" class="selflink">#</a></p><div class="doc"><p>The inverse of <code><a href="Programs-QCLParser-Main.html#v:qcl_fanout">qcl_fanout</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:testcircuit1" class="def">testcircuit1</a> :: <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-166" class="link">Source</a> <a href="#v:testcircuit1" class="selflink">#</a></p><div class="doc"><p>A sample circuit to illustrate how to use the primitives.</p></div></div><h1 id="g:4">Unpacking QCLCirc</h1><div class="top"><p class="src"><a id="v:run" class="def">run</a> :: <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> a -&gt; <a href="Quipper-Monad.html#t:Circ">Circ</a> a <a href="src/Programs/QCLParser/Main.html#line-182" class="link">Source</a> <a href="#v:run" class="selflink">#</a></p><div class="doc"><p>Run function for the <code><a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a></code> monad: execute the actions and
 produce a circuit.</p></div></div><h1 id="g:5">An abstract syntax for QCL output</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:QCLGate" class="def">QCLGate</a> <a href="src/Programs/QCLParser/Main.html#line-191" class="link">Source</a> <a href="#t:QCLGate" class="selflink">#</a></p><div class="doc"><p>A data type to hold a QCL gate.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Comment" class="def">Comment</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Reset" class="def">Reset</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Not" class="def">Not</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:XNot" class="def">XNot</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:CNot" class="def">CNot</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:XCNot" class="def">XCNot</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Fanout" class="def">Fanout</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:XFanout" class="def">XFanout</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Matrix" class="def">Matrix</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:XMatrix" class="def">XMatrix</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>&#93; &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:QCLGate" class="caption collapser" onclick="toggleSection('i:QCLGate')">Instances</p><div id="section.i:QCLGate" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:QCLGate:Show:1" class="instance expander" onclick="toggleSection('i:id:QCLGate:Show:1')"></span> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-Show.html#t:Show">Show</a> <a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a></span> <a href="#t:QCLGate" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:QCLGate:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a> -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: &#91;<a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a>&#93; -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:do_qcl_gate" class="def">do_qcl_gate</a> :: <a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-206" class="link">Source</a> <a href="#v:do_qcl_gate" class="selflink">#</a></p><div class="doc"><p>Take a gate from the abstract syntax and execute it in the
 <code><a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a></code> monad.</p></div></div><h1 id="g:6">Parsing</h1><div class="doc"><p>The output of QCL consists of lines of the following forms. Lines
 not starting with &quot;@&quot; are comments or other non-circuit output.</p><pre>@ RESET
@ NOT(qureg q=&lt;5&gt;)  
@ CNOT(qureg q=&lt;31&gt;,quconst c=&lt;4,30&gt;)
@ !CNOT(qureg q=&lt;31&gt;,quconst c=&lt;4,30&gt;)
@ Fanout(quconst a=&lt;47,48,49,50,51,52&gt;,quvoid b=&lt;40,41,42,43,44,45&gt;;cond=&lt;&gt;)
@ !Fanout(quconst a=&lt;47,48,49,50,51,52&gt;,quvoid b=&lt;40,41,42,43,44,45&gt;;cond=&lt;&gt;)
@ Matrix4x4(complex u00=1,complex u01=0,complex u02=0,complex u03=0,complex u10=0,complex u11=1,complex u12=0,complex u13=0,complex u20=0,complex u21=0,complex u22=(0.995004,-0.0998334),complex u23=0,complex u30=0,complex u31=0,complex u32=0,complex u33=(0.995004,0.0998334),qureg q=&lt;12,13&gt;)
@ !Matrix4x4(complex u00=1,complex u01=0,complex u02=0,complex u03=0,complex u10=0,complex u11=0.707107,complex u12=0.707107,complex u13=0,complex u20=0,complex u21=0.707107,complex u22=-0.707107,complex u23=0,complex u30=0,complex u31=0,complex u32=0,complex u33=1,qureg q=&lt;0,6&gt;)  </pre><p>We use Koen Claessen's parser combinators (see
 <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html">Text.ParserCombinators.ReadP</a>) to implement the parser.</p></div><div class="top"><p class="src"><a id="v:identifier" class="def">identifier</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> <a href="src/Programs/QCLParser/Main.html#line-238" class="link">Source</a> <a href="#v:identifier" class="selflink">#</a></p><div class="doc"><p>Parse a QCL identifier, which we take to be a non-empty string of
 alphanumeric characters, starting with a letter</p></div></div><div class="top"><p class="src"><a id="v:int" class="def">int</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a> <a href="src/Programs/QCLParser/Main.html#line-245" class="link">Source</a> <a href="#v:int" class="selflink">#</a></p><div class="doc"><p>Parse a signless integer. We avoid the usual trick (<code><a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#v:readS_to_P">readS_to_P</a></code>
 <code><a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-Read.html#v:reads">reads</a></code>), because this introduces backtracking errors.</p></div></div><div class="top"><p class="src"><a id="v:double" class="def">double</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a> <a href="src/Programs/QCLParser/Main.html#line-253" class="link">Source</a> <a href="#v:double" class="selflink">#</a></p><div class="doc"><p>Parse a floating point number. We avoid the usual trick
 (<code><a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#v:readS_to_P">readS_to_P</a></code> <code><a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-Read.html#v:reads">reads</a></code>), because this introduces backtracking
 errors.</p></div></div><div class="top"><p class="src"><a id="v:commalist" class="def">commalist</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> a -&gt; <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> &#91;a&#93; <a href="src/Programs/QCLParser/Main.html#line-264" class="link">Source</a> <a href="#v:commalist" class="selflink">#</a></p><div class="doc"><p>Parse a comma separated list.</p></div></div><div class="top"><p class="src"><a id="v:qureg" class="def">qureg</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a>, &#91;<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Int.html#t:Int">Int</a>&#93;) <a href="src/Programs/QCLParser/Main.html#line-272" class="link">Source</a> <a href="#v:qureg" class="selflink">#</a></p><div class="doc"><p>Parse a QCL quantum register of the form </p><pre>q=&lt;31,32&gt;
c=&lt;4,31&gt;
b=&lt;40,41,42,43,44,45&gt;.</pre></div></div><div class="top"><p class="src"><a id="v:inversechar" class="def">inversechar</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#t:Bool">Bool</a> <a href="src/Programs/QCLParser/Main.html#line-284" class="link">Source</a> <a href="#v:inversechar" class="selflink">#</a></p><div class="doc"><p>Consume an optional &quot;!&quot;. Return <code><a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#v:True">True</a></code> if consumed, and <code><a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bool.html#v:False">False</a></code>
 otherwise.</p></div></div><div class="top"><p class="src"><a id="v:complex" class="def">complex</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> (<a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Complex.html#t:Complex">Complex</a> <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Double">Double</a>) <a href="src/Programs/QCLParser/Main.html#line-296" class="link">Source</a> <a href="#v:complex" class="selflink">#</a></p><div class="doc"><p>Parse a complex number declaration of the format</p><pre>complex u00=1</pre><p>or</p><pre>complex u22=(0.995004,-0.0998334).</pre></div></div><div class="top"><p class="src"><a id="v:qcl_line" class="def">qcl_line</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Text-ParserCombinators-ReadP.html#t:ReadP">ReadP</a> <a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a> <a href="src/Programs/QCLParser/Main.html#line-323" class="link">Source</a> <a href="#v:qcl_line" class="selflink">#</a></p><div class="doc"><p>Parse a single line of QCL output into a <code><a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:parse_qcl_line" class="def">parse_qcl_line</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a> <a href="src/Programs/QCLParser/Main.html#line-435" class="link">Source</a> <a href="#v:parse_qcl_line" class="selflink">#</a></p><div class="doc"><p>String version of <code><a href="Programs-QCLParser-Main.html#v:qcl_line">qcl_line</a></code>: parse a string and turn it into a
 <code><a href="Programs-QCLParser-Main.html#t:QCLGate">QCLGate</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:run_qcl_line" class="def">run_qcl_line</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-450" class="link">Source</a> <a href="#v:run_qcl_line" class="selflink">#</a></p><div class="doc"><p>Monad version of <code><a href="Programs-QCLParser-Main.html#v:parse_qcl_line">parse_qcl_line</a></code>: parse a string and execute the
 resulting gate directly in the <code><a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a></code> monad.</p></div></div><div class="top"><p class="src"><a id="v:run_qcl_lines" class="def">run_qcl_lines</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String">String</a> -&gt; <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-455" class="link">Source</a> <a href="#v:run_qcl_lines" class="selflink">#</a></p><div class="doc"><p>Parse a stream consisting of many lines of QCL output and execute
 the parsed gates in the <code><a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a></code> monad.</p></div></div><div class="top"><p class="src"><a id="v:testcircuit2" class="def">testcircuit2</a> :: <a href="Programs-QCLParser-Main.html#t:QCLCirc">QCLCirc</a> () <a href="src/Programs/QCLParser/Main.html#line-460" class="link">Source</a> <a href="#v:testcircuit2" class="selflink">#</a></p><div class="doc"><p>A sample circuit to illustrate the parser.</p></div></div><h1 id="g:7">Main function</h1><div class="top"><p class="src"><a id="v:main" class="def">main</a> :: <a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#t:IO">IO</a> () <a href="src/Programs/QCLParser/Main.html#line-472" class="link">Source</a> <a href="#v:main" class="selflink">#</a></p><div class="doc"><p>Main function: read a circuit in QCL format from <code><a href="http://hackage.haskell.org/package/base-4.9.0.0/docs/GHC-IO-Handle-FD.html#v:stdin">stdin</a></code>, and
 preview the translated Quipper circuit.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>
